<!doctype html><html dir=auto lang=en><head><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content="index, follow" name=robots><title>CPU Mining Blinded Secrets</title><meta content="keyword1, keyword2, keyword3" name=keywords><meta name=description><meta content=vnprc name=author><link href=https://hashpool.dev/dev-logs/dev-log-2024-09-08/ rel=canonical><link href=https://hashpool.dev/css/includes/scroll-bar.css rel=stylesheet><link href=https://hashpool.dev/css/styles.css rel=stylesheet><link href=https://hashpool.dev/css/override.css rel=stylesheet><link href=https://hashpool.dev/atom.xml rel=alternate title=RSS type=application/atom+xml><noscript><style>#theme-toggle,.top-link{display:none}</style> <style>@media (prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:#dadadb;--secondary:#9b9c9d;--tertiary:#414244;--content:#c4c4c5;--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><body id=top><script>if(localStorage.getItem(`pref-theme`)===`dark`){document.body.classList.add(`dark`)}else if(localStorage.getItem(`pref-theme`)===`light`){document.body.classList.remove(`dark`)}else if(window.matchMedia(`(prefers-color-scheme: dark)`).matches){document.body.classList.add(`dark`)}</script><header class=header><nav class=nav><div class=logo><a title="Hashpool (Alt + H)" accesskey=h href=https://hashpool.dev> Hashpool </a><div class=logo-switches><button title="(Alt + T)" accesskey=t id=theme-toggle><svg viewbox="0 0 24 24" fill=none height=18 id=moon stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg> <svg viewbox="0 0 24 24" fill=none height=18 id=sun stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><circle cx=12 cy=12 r=5></circle><line x1=12 x2=12 y1=1 y2=3></line><line x1=12 x2=12 y1=21 y2=23></line><line x1=4.22 x2=5.64 y1=4.22 y2=5.64></line><line x1=18.36 x2=19.78 y1=18.36 y2=19.78></line><line x1=1 x2=3 y1=12 y2=12></line><line x1=21 x2=23 y1=12 y2=12></line><line x1=4.22 x2=5.64 y1=19.78 y2=18.36></line><line x1=18.36 x2=19.78 y1=5.64 y2=4.22></line></svg></button><ul class=lang-switch><li></ul></div></div><ul id=menu><li><a href=https://hashpool.dev title=About> <span>About</span> </a><li><a title="Development Logs" href=https://hashpool.dev/dev-logs> <span>Development Logs</span> </a><li><a href=https://hashpool.dev/search title=Search> <span>Search</span> </a><li><a href=https://github.com/vnprc/hashpool title=Github> <span>Github</span> </a></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hashpool.dev>Home</a> »  <a href=https://hashpool.dev/dev-logs/>Developer Logs</a> »  <a href=https://hashpool.dev/dev-logs/dev-log-2024-09-08/>CPU Mining Blinded Secrets</a></div><h1 class=post-title>CPU Mining Blinded Secrets</h1><div class=post-meta><span title="2024-09-08 00:00:00 +0000">2024-09-08</span> · 3 min · vnprc</div></header><div class=post-content><p>This week I had three wins:<ul><li>began generating blinded secrets upon share submission<li>ported my work from the benchmarking tool to the real Sv2 project<li>got it working with a cpu miner</ul><p>I added my fork of cdk as a dependency to the Sv1 proxy and started generating blinded secrets on share submission. I got this working on <a href=https://github.com/vnprc/benchmarking-tool/tree/hashpool-demo>my fork of the benchmarking tool</a> and realized that in order to sign the blinded secrets the next step would involve modifying solo pool, which is written in typescript. There is a typescript cashu library in active development but I don't think the benefits of using the benchmarking tool outweigh the complexity of adding more codebases in different languages. I realized that I could drop the benchmarking tool and just run Sv2 daemons directly to keep all development within the Sv2 and cdk projects. I have been looking for a hacky shortcut since I started this project and this week I realized that the 'right' way to build it is actually the shortest path to my goal.<p>I found this awesome <a href=https://stratumprotocol.org/getting-started/>getting started guide</a> and using the easy mode instructions I was able to point a CPU miner at the public testnet Sv2 instance. With this stack I ported over my blinded secret code from the simple Sv1 proxy in the benchmarking tool to the <a href=https://github.com/vnprc/stratum/tree/hashpool-demo>Sv2 translator proxy</a>. I fake the stuff the wallet needs from the mint and randomly generate blinded secrets instead of deterministic generation. This let me produce blinded secrets without any extra work to manage the mint state.<p>I also played with the cpu miner found in those instructions and found that it was easy to get running with the right settings. I can pull 47 megahash on my macbook, which is plenty of juice to generate eHash tokens. The advantage of this setup is that I don't need to mess with my bitaxe anymore to produce hashrate. The bitaxe will prove useful for testing the final product but reconfiguring it is very slow and adds a network connection to the critical path that will likely cause problems during a live demo. With the cpu miner I can demo the full system with only my laptop and an internet connection.<p>You can try it out yourself:<pre style=color:#c0c5ce;background-color:#2b303b><code><span>git clone git@github.com:vnprc/stratum.git
</span><span>cd stratum
</span><span>git checkout hashpool-demo
</span></code></pre><p>follow the simple setup instructions found <a href=https://stratumprotocol.org/getting-started/#run-job-declarator-client-jdc>here</a><ul><li>Run Job Declarator Client (JDC)<li>Run Translator Proxy<li>CPU Miner</ul><p>I have adjusted the proxy settings to tune the rate of mining shares produced by my CPU to be reasonably fast.<p>Next week dev goals:<ol><li>adapt my setup to <a href=https://stratumprotocol.org/getting-started/#ii-getting-started---running-all-roles>run all roles</a> <ul><li>The publicly available Sv2 pool was not accepting connections at first. I posted to the stratum discord and gitgab fixed it quickly but this is a dependency I need to remove for a successful demo.</ul><li>Add a cashu mint to pool <ul><li>it needs to handle keyset generation and signing blinded secrets</ul><li>Find a way to include blinded secrets and signatures in the stratum share submission request and response messages<li>Combine mint signatures with unblinded secrets to make ecash (aka proofs) and store in the cashu wallet.</ol></div><footer class=post-footer><nav class=paginav></nav></footer></article></main><footer class=footer><span>© 2025 <a href=https://github.com/vnprc>vnprc</a></span><span> Powered by <a rel="noopener noreferrer" href=https://www.getzola.org/ target=_blank>Zola</a> & <a href=https://github.com/cydave/zola-theme-papermod rel=noopener target=_blank>PaperMod</a> </span></footer><a aria-label="go to top" title="Go to Top (Alt + G)" accesskey=g class=top-link href=#top id=top-link> <svg viewbox="0 0 12 6" fill=currentColor xmlns=http://www.w3.org/2000/svg><path d="M12 6H0l6-6z"/></svg> </a><script>let menu=document.getElementById(`menu`);if(menu){let a=`menu-scroll-position`;menu.scrollLeft=localStorage.getItem(a);menu.onscroll=(()=>{localStorage.setItem(a,menu.scrollLeft)})};document.querySelectorAll(`a[href^="#"]`).forEach(a=>{let c=null,b=decodeURIComponent;a.addEventListener(`click`,function(a){a.preventDefault();var d=this.getAttribute(`href`).substr(1);if(!window.matchMedia(`(prefers-reduced-motion: reduce)`).matches){document.querySelector(`[id='${b(d)}']`).scrollIntoView({behavior:`smooth`})}else{document.querySelector(`[id='${b(d)}']`).scrollIntoView()};if(d===`top`){history.replaceState(c,c,` `)}else{history.pushState(c,c,`#${d}`)}})})</script><script>var mybutton=document.getElementById(`top-link`);window.onscroll=(()=>{let a=800;if(document.body.scrollTop>a||document.documentElement.scrollTop>a){mybutton.style.visibility=`visible`;mybutton.style.opacity=`1`}else{mybutton.style.visibility=`hidden`;mybutton.style.opacity=`0`}})</script><script>document.getElementById(`theme-toggle`).addEventListener(`click`,()=>{let a=`dark`,b=`pref-theme`;if(document.body.className.includes(a)){document.body.classList.remove(a);localStorage.setItem(b,`light`)}else{document.body.classList.add(a);localStorage.setItem(b,a)}})</script><script>document.querySelectorAll(`pre > code`).forEach(a=>{let f=`TABLE`,e=`copy`;var d=(()=>{c.innerText=`copied!`;setTimeout(()=>{c.innerText=e},2000)});const b=a.parentNode.parentNode;const c=document.createElement(`button`);c.classList.add(`copy-code`);c.innerText=e;c.addEventListener(`click`,b=>{if(`clipboard` in navigator){var c=a.textContent;if(a.firstChild.tagName==f){c=Array(...a.firstChild.getElementsByTagName(`span`)).map(a=>a.textContent).join(``)};navigator.clipboard.writeText(c);d();return};const g=document.createRange();g.selectNodeContents(a);const h=window.getSelection();h.removeAllRanges();h.addRange(g);try{document.execCommand(e);d()}catch(a){}h.removeRange(g)});if(b.classList.contains(`highlight`)){b.appendChild(c)}else if(b.parentNode.firstChild==b){}else if(a.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName==f){a.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(c)}else{a.parentNode.appendChild(c)}})</script>